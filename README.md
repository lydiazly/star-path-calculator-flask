# PlotStarTrail - Flask

[![python](https://img.shields.io/badge/Python-3.10,_3.11-3776AB?logo=python&logoColor=white)](https://www.python.org) [![numpy](https://img.shields.io/badge/Numpy-2.0.1-013243?logo=numpy&logoColor=white)](https://numpy.org) [![pandas](https://img.shields.io/badge/Pandas-2.2.2-150458?logo=Pandas&logoColor=white)](https://pandas.pydata.org) [![matplotlib](https://img.shields.io/badge/Matplotlib-3.9.1.post1-12557C)](https://matplotlib.org) [![skyfield](https://img.shields.io/badge/Skyfield-1.49-BD9354)](https://rhodesmill.org/skyfield) [![juliandate](https://img.shields.io/badge/Juliandate-1.0.4-BD9354)](https://pypi.org/project/juliandate) [![tzfpy](https://img.shields.io/badge/tzfpy-0.15.5-blue)](https://github.com/ringsaturn/tzfpy) [![Flask](https://img.shields.io/badge/Flask-3.0.3-39A6BD?logo=flask&logoColor=white)](https://flask.palletsprojects.com)

A Flask server of [PlotStarTrail](https://github.com/claude-hao/equinox-coord).

## Install

```sh
python3 -m pip install pandas matplotlib skyfield juliandate tzfpy Flask
```

## Usage

Run the Flask app locally in development mode:

```sh
python3 run.py
```

The server will be running on <https://localhost:5001>

A local CA is required, see below.

## SSL

1. Install [mkcert](https://github.com/FiloSottile/mkcert)

   Mac:

   ```sh
   brew install mkcert
   ```

2. Create a local certificate authority (CA) with mkcert:

   ```sh
   mkcert -install
   ```

   This command creates and installs a local CA to your system, making any certificate generated by `mkcert` trusted.
   The CA certificate and its key are stored in an application data folder in the user home, which can be printed by: `mkcert -CAROOT`

3. Generate a certificate and private key for your local development domain:

   ```sh
   mkcert -cert-file localhost.pem -key-file localhost-key.pem localhost 127.0.0.1 ::1
   ```

   - This command generates your certificate and key files `localhost.pem` and `localhost-key.pem`.
   - Including `::1` ensures that the certificate is also valid IPv6.
   - In [run.py](./run.py), specify the certificate and the key: `app.run(ssl_context=('localhost.pem', 'localhost-key.pem'))`.

4. Clear browser cookies of localhost
Chrome: [chrome://settings/content/all](chrome://settings/content/all)
Delete the site data of `localhost`, restart the browser to test.
